#Linuxの常識  
##今押さえておきたい最新トピックス  
* オープンソース  
	- 特定の企業が開発するのではなく、インターネット上でオープンに、自由に開発をすすめるスタイル。  
	  無償で利用でき、再配布も自由  
* LAMP  
	- Webサービスを提供するオープンソフトウェアの組み合わせ。  
	  OSソフトウェアとしてLinux、WebサーバーとしてApache、データベース管理としてMySQL、プログラミング言語としてPHPという頭文字をとってLAMP。
	- PHPの代わりとしてPythonやPerlが使われることもある。
* Android  
	- スマートフォンOS。Androidの中核部にはLinuxが使われているので、Androidスマートフォンを使っているユーザーはLinuxユーザでもある。  
* クラウドサーバー  
	- 仮想的なサーバーをソフトウェアで実現することで、必要に応じて簡単にサーバーの能力を増強できる。  
	- 最初は低予算低スペックでスタートし、利用者の増加に応じて無駄なくサーバーを増強できる。  
* VPS  
	- 特殊なソフトウェアを使って仮想的な専用サーバーを提供するサービス。  
	- 専用サーバーの使い勝手を確保しつつ、専用サーバーよりもコストを抑えることができます。  
	- セキュリティ管理などが自己責任となる点には注意が必要。  
* 仮想化  
	- 物理的なネットワークやサーバー、ストレージと同様の機能を、ソフトウェアを使って仮想的に実現すること。  
	- 物理的な装置を用意するよりもコストを低くできるということ、柔軟な運用が可能になるメリットがある。  
* 軽量ディストビリューション  
	- 通常のディストビリューションよりも動作が軽いため、古いスペックのパソコンでも快適に使えるように作られている。  
	- 例: Tiny Core Linux、Puppy Linux、Linux Mint etc...  

##サーバー管理者の一日  
 * これまでの経緯  
 * ログをチェックする  
 * リソースを管理する  
 * VPSサービスを借りる
 * VPSでWebサーバー構築する  
 * トラブルに対応する  
 * ユーザを追加する  

##1.Linuxの基礎知識 
###1-1  サーバーとは  
* サーバーとクライアント  
 	- サーバー:他のコンピュータに対してサービスを提供する
 	- クライアント:サーバーに対して処理を要求する
 	- クライアント・サーバー:コンピュータが「サーバー」 もしくは「クライアント」という役割を分担して処理を進める形式  
 * OS  
 	- ハードウェアを制御し、応用ソフトウェアが動作するための基本的な機能を提供するもの  
 	- 例: Windows, OS X, Unix etc...  
 * サーバーOSとは  
 	- 多くのクライアントからアクセスされるため、数多くのネットワークにアクセスし、滞りなくスピーディーにサービスを提供できる  
 	- LinuxはサーバーOSにとても適していて、安定していて信頼感もあり、利用者も多くてノウハウもたくさんある技術者にとっては扱いやすい魅力的なOS  

###1-2 代表的なサーバーソフトウェア 
* Webサーバー  
 	- Webサイトを公開するためのサーバー  
 	- Webサーバーからの要求に応じてWebページの情報を提供する  
 	- 代表的なWebサーバー: Apache, Nginx, IIS etc...  
* メ−ルサーバー  
  	- 電子メールをやり取りするためのサーバー  
  	- 送信時: SMTP  
  	- 受信時: IMAP POP  
  * ファイルサーバー  
  	- ネットワーク上でファイルを共有できるようにするサーバー  
  	- プリンタサーバーやActive Directoryドメインコントローラとしての機能も持っているので、WindowsサーバをLinuxサーバに置き換えることも可能  
* DNSサーバ  
  	- インターネットで使われるアドレスであるIPアドレスに変換するサーバー  
  	- インターネット上では数字で表示される  
  	- IPアドレスがコンピューターやサーバーのアドレスとして使われる  
  	- Webのアドレス欄に「`www.google.com`」とかって入力するとDNSサーバーが自動的に数値のIPアドレスに変換してくれる  
* FTPサーバー
  	- ネットワーク経由でファイルを転送するためのサーバー  
  	- ネット上からファイルをダウンロードするために使う  
  	- 原則としてアカウントが必要  
  	- WebブラウザはFTPクライアントとしての機能を持っているので、FTPサーバーからファイルをダウンロードできる  
* データベースサーバー  
  	- たくさんのデータを集めて、効率的に検索したり更新したりできるようにしたデータの集合体をデータベースという  
  	- そのデータベースを運用・管理するソフトウェアがデータベース管理システム  
  	- 上記２つを備え、Webサーバーなどにデータを提供するサーバーをデータベースサーバーという  
* プロキシサーバー  
  	- クライアントの代理としてWebサーバーやFTPサーバーにアクセスするサーバーのこと  
  	- インターネット上のWebサイトへのアクセス制限を行える  
  	- Webページの閲覧履歴を保存しておける  
  	- セキュリティを高めることができる  
* アプリケーションサーバー  
  	- Webアプリケーションを実行するための基盤を提供するサーバー  
  	- Javaなどのプログラム  の実行環境、データベースの接続機能、トランザクションの管理機能がある 

###1-3 Linuxとは 
*  Unix・Linuxとは   
    - Unix:1960年代の終わりに開発が始まり、大学や研究機関を中心に広まった。初期のインターネットはUnixで構成されていた   
    - Linux:Unixに互換性のあるOSをフィンランドの学生が一人で作り始め、インターネットに公開した。現在では企業や学校、官公庁などに広く採用されている  
* カーネルとは  
    - OSの中核部分のこと  
    - ハードウェアの違いを吸収し、アプリケーション・ソフトウェアが動作するための基盤となる機能を提供する  
* ディストビリューションとは  
    - カーネルだけではOSとして利用できないので、カーネルにさまざまなソフトウェアを組み合わせてひとつのOSとして完成させたのがディストビリューション  
    - 企業が作っているものもあれば、少人数のインターネット・コミュニティや個人が作っているものもある  
    - マルチメディア向け、サーバー向け、パソコン向け、教育向け、ネットワークのテスト用、大規模なサーバー向けなど多彩なラインナップで、多くは無償で提供されている   
* フリーソフトとオープンプライス  
    - フリーソフト：無償で利用できるソフトウェアのこと  
    - オープンソース: フリーソフトが単に「無料である」という意味で捉えられるようになったので新たに作られた言葉  
* Linuxのサポート期間  
    - Linuxディストビリューションのサポート期間は、ディストビリューションによって大きく異なる  
* ディストビリューションの選び方  
    - 運用するサーバーにかけられるコストを考える。それほどコストをかけられないのであれば、無料のディストビリューションをつかう  
    - サーバーの重要性が高く、何か問題が発生した時に原因究明して速やかに復旧しなければならないのであれば、有料ディストビリューションを選択する  

###1-4 Linuxの使いみち  
* イントラネットサーバー  
    - インターネットに公開せず、社内ネットワーク上でグループウェアやSNS、掲示板などの業務ソフトウェアを動かしたり、ファイルやサーバーやプリンターサーバーとなるもの  
    - イントラネットサーバーにはWindowsを使っているところが多いですが、Linuxでも同等のことが可能  
* デスクトップクライアント  
    - Linuxは日本ではほとんど見かけないが、Linuxを搭載したパソコンも世界中で販売されていて、価格が安いので、発展途上国では多くのシェアを占めている  
    - Windowsが圧倒的、ついてMac OS X  
* 組み込み機器  
    - 液晶テレビや家庭用ルーター、スマートフォンや携帯電話にもOSは組み込まれている  
    - OSが無償であり、機器のハードウェアにあわせて細かく調整しやすいLinuxが採用されやすい  

##2.Linuxの基本操作  
###2-1 コマンドを使った操作  
* コマンドとは  
    - Linuxでは基本的にコマンドを使って操作をする  
    - GUI: ディスプレイにアイコンやウィンドウが並び、マウスを使ったり指タッチしたりして操作する  
    - CUI: 文字だらけの画面を見ながらキーボードから文字を入力して操作する  
    - コマンド: CUIでキーボードからLinuxに送られる様々な「指示」のこと  
* 端末とは  
    - コンピュータを操作する窓口  
    - ディスプレイとキーボードのセット  
* ログインとログアウト  
    - ログイン: 正しいパスワードを入力し、正規のユーザとしてシステムが利用できるようになること  
    - ログアウト: ログインの反対で、システムの利用を終了すること  
* ユーザーアカウントとは  
    - 管理ユーザー: Linuxシステムを管理する権限を持ったユーザー。スーパーユーザーともいう  
    - システムユーザー: システムプログラムやサーバーソフトウェアなどを実行するために用意されたユーザー  
    - 一般ユーザー: 通常のLinuxの利用者で、システムを管理権限はない  
* rootユーザーとは  
    - Linuxのシステムの管理権限をもったユーザー  
    - 繊細な操作ミスからシステムに重大な損害を与えることもあるので、取り扱いには最新の注意が必要  
* プロンプトとは 
    - コマンドを入力出来る場所    
* コマンド操作の基本  
    - 1.コマンドを入力する  
    - 2.[Enter]キーを押す  
    - 3.コマンドが実行されて実行結果が表示される  
* オプションとは  
    - 引数などとは別に、コマンドの挙動を変更するためのスイッチがある  
    - つけてもつけなくてもいい  
    [-]と英数字1文字で表す  
* 代表的なLinuxコマンド  

|コマンド     | 説明|
|:------------|:------------|
| ls          |ファイルの一覧を表示|  
| cat         |ファイルの内容を表示|   
|cd           |指定したディレクトリに移動|
|pwd          |カレントディレクトリを表示|
|cp           |ファイルをコピーする|
|mv           |ファイルやディレクトリを移動する|
|rm           |ファイルやディレクトリを削除する|
|chmod        |ファイルやディレクトリのアクセス権を変更する|
|chown        |ファイルやディレクトリの所有者を変更する|
|chgrp        |ファイルやディレクトリの所有グループを変更する|
|history      |コマンド履歴を表示する|
|su            |一時的に別のユーザーになる|
|passwd       |パスワードを変更する|
|top           |システムの状態をモニターする|
|free          |メモリの使用状況を確認する|
|df            |ディスクの使用状況を表示する|

###2-2 ファイルとディレクトリ  
* ディレクトリとは  
    - フォルダのこと  
    - サブディレクトリ:ディレクトリの中のディレクトリ  
* Linuxディレクトリの構造  
    - すべてのファイルやディレクトリはルートディレクトリというトップディレクトリに収められている  
* 絶対パスとは  
    - ルートディレクトリを起点としてファイルやディレクトリの場所を表す方法  
* カレントディレクトリとは  
    - ユーザが現在いるディレクトリのこと  
* 相対パスとは  
    - カレントディレクトリを起点としてファイルやディレクトリの場所を表す方法  
* ホームディレクトリとは  
    - ログインした時点でカレントディレクトリとなるディレクトリ  
* ファイルを表示する  
    - カレントディレクトリ内にどんなファイルがあるかを確認するにはlsコマンドを使う  
* ディレクトリを作成  
    - ディレクトリを作成するにはmkdirコマンドを使う  
* ファイルの所有者  
    - lsのオプションを使って、ファイルやディレクトリの所有者を確認することが出来る  


##3.Linuxサーバ構築の基礎知識  
###3-1 サーバーを公開する  

|自社でサーバーを用意する|レンタルサーバーを契約する|
|:------------|:------------:|
|社内に設置場所を準備するか、データセンターと契約する|↓|  
|固定のIPアドレスを用意する|↓|  
|独自ドメインを用意する|独自ドメインを用意する|
|Linuxをインストールしサーバーの設定を行う|Linuxをインストールしサーバーの設定を行う|
|ファイルをアップロードしてWebサイトを公開する|ファイルをアップロードしてWebサイトを公開する|

###3-2 サーバーを用意する手段 
* PCサーバー  
    - 見かけや性能がパソコンに近いサーバー  
    - 性能や信頼性、可用性を高めるために専用のパーツが使われている  
* レンタルサーバー(ホスティング)  
    - 事業者がレンタルサーバーもネットワーク機器もネットワーク回も用意し、利用者はそれを借り受ける形態  
    - レンタル料は発生するが、最初にサーバーを購入するよりも導入コストが安くすむ  
* レンタルサーバー(ハウジング)  
    - サーバーの設置場所とネットワーク回線を借り受ける形態  
* VPS  
    - 1台のサーバーをソフトウェア的に分割し、外部からは複数のサーバーであるかのように見せかける  
* クラウドサーバー  
    - VPSを更に進化させたもの  
    - 仮想的なサーバーを借り受けるという点はVPSと一緒  
    - クラウドサーバーの場合、必要に応じてメモリやディスク容量、CPUパワー、仮想サーバーの台数を直ちに増やすことが出来る   

##4.Linuxのサーバ運用の基礎知識  
###4-1 サーバーの運用のポイント  
* サーバーの運用  
    - リソース管理   
    - リモート管理  
    - バックアップ  
    - ソフトウェアのアップデート  
* メモリの使用状況を調べる 
    - メモリが不足するとシステムのパフォーマンスが落ちてしまう  
* ハードディスクの使用量を調べる  
    - dfコマンドを実行すると、ハードディスクの使用量や空き容量を調べることが出来る、実行するとハードディスクのパーティションごとに情報が表示される  
* SSHとは  
    - ネットワーク経由でサーバーをリモート管理する仕組み  
* バックアップの考え方  
    - フルバックアップ  
    ディスク全体をすべてバックアップする方法  
    - 差分バックアップ  
    フルバックアップ以降に作成されたり更新された部分のデータをバックアップする  
    - 増分バックアップ  
    なんらかのバックアップ以降に作成されたりした部分のデータだけをバックアップする  
    - バックアップを戻すには  
    dumpコマンドを使った時はrestoreコマンドで、tarコマンドやrsyncコマンドの場合は同じコマンドでリストアする  

###4-2 ソフトウェアの管理  
* パッケージとは  
    - ソフトウェアの単位。形式によってインストール出来るものが違う  
* パッケージ管理システムとは  
    - ソフトウェアを指定して、インターネット上からダウンロードし、インストールする仕組みのこと  
* パッケージのインストール  
    - CentOsならyumコマンドを使って実行するだけ  
* システムのアップデート  
    - システムをアップデートすると、OSのみならず、インストールされているアプリケーション・ソフトウェアも自動的に最新版にアップデートされる  

###4-3 現場で役立つLinuxサーバー管理の知識   
* サービスとは  
    - 「Webサーバー」や「メールサーバー」、システムのログを記録する「システムロギング」機能など、システム常駐して利用者や管理者(または他のプログラム)に対して情報を提供するプログラムのこと  
* サービスの管理  
    - サービスを管理するにはserviceコマンドを使う  
* サービスの追加  
    - サーバーを複数のユーザーで管理するなら、Linuxのユーザーを追加する必要がある  
    - rootユーザーでuseraddコマンドを実行する  
* パスワードの設定と変更  
    - 作成したユーザーにはパスワードが設定されていない  
    - ログインが不可能  
    - パスワードを設定するには、rootユーザーでpasswdコマンドを実行する  
* ファイルの転送  
    - ネットワーク経由でファイルをダウンロードしたりコピーしたりする場合にwgetコマンドを使う  
    - サーバー間でファイルを転送したい場合はscpコマンドを使う  
* 処理の自動化  
    - 毎朝4時にシステムをチェックするなど、定期的に繰り返したい処理があるとする、Linuxにはcronというスケジュール登録システムがある  
    - crontabコマンドを使ってスケジュールを予約することが出来る  
* ログの管理  
    - Linuxでは、システムやサーバーの挙動はログに記録される  
    - ログが格納されたログファイルは、/var/log/ ディレクトリ以下にある  

|ログファイル|説明|
|:-----------|:---|
|/var/log/messages |メインなどのログファイル|
|/var/log/secure |ログインなどのユーザー認証関係のログファイル|
|/var/log/maillog |メールサーバーのログファイル|
|/var/log/cron |cronの実行ログファイル|
|/var/log/httpd/access_log|Apache Webサーバーのアクセスログ|
|/var/log/httpd/error_log |Apache Webサーバーのエラーログ|  

* システムのシャットダウン  
    - サーバーのシステムを終了して電源を切るには、シャットダウン操作をする必要がある  
    - シャットダウンなしで電源を切ると、ディスクが読み込めなくなるなど不具合が発生する恐れがある  
    - システムをシャットダウンするには、rootユーザーでshutdownコマンドを実行する  

##5.セキュリティの基礎知識  
###5-1 セキュリティの基礎知識  
* インターネット上にある危険  
    - 不正侵入  
    正規ユーザーでもないのにシステムに勝手に潜り込むこと  
    - Dos/DDos攻撃  
    Dos攻撃:ネットワーク経由で大量のデータを送りつけることで、本来の利用者が正常なサービスを受けられなくなるようにする攻撃  
    DDos攻撃:何千ものコンピュータにウイルスを仕掛け、目標を同時に攻撃する攻撃  
    - トロイの木馬  
    インターネット上からダウンロードしたソフトウェアをインストールすると、中に潜ませていた悪意あるプログラム
* 最新ではないソフトウェアは危険  
    - ソフトウェアは人が作るものなので、どうしても不具合がでてくる  
    - 不具合が発見されると、ソフトウェアの開発側は急いで不具合を修正し、新しいバージョンとして公開する  
* サーバー管理者が招く危険  
    - サーバーのセキュリティが破られる原因は、サーバー管理者自らが作ってしまっていることがある  
    - ソフトウェアのインストール時にセキュリティ設定を緩めてそのまま忘れたり、自分が理解できないままサーバー設定をインターネット上の情報からコピペした所、侵入されやすい設定になっていたのに気づかなかったなどがある  
* Linuxサーバーが乗っ取られたら？  
    - サーバーに需要な情報が格納されていた場合、それが外部に漏れだしてしまう  
    - 重要な情報を扱っていないWebサーバーが小劇を受けた場合、侵入したサーバーを土台にして別の攻撃対象に攻撃を仕掛ける  

###5-2 知っておきたいセキュリティ技術  
* パーミッション  
    - パーミッションにしたがって許可された操作しかできない  
    - パーミッションを甘くしてしまうと第三者に侵入されやすくなる  
* 暗号化技術  
    - SSL/TLS
    主にWebブラウザとWebサーバーとの通信を暗号化するために使われている  
    通常のWebサーバーへのアクセス時には  
    `http://~`  
    となっているが、SSL/TLSを使った通信では、  
    `https://~`のようにhttpに「s」がつく  
* ファイヤーウォール  
    - システムによって入ってくるパケットや出て行くパケットを調べ、条件によってパケットを遮断する仕組み  
    - Linuxでは標準的にファイヤーウォールがどう際している  
* IDS  
    - サーバーに侵入されたかどうかをチェックするセキュリティ・ソフトウェアのこと  
    - 攻撃を確認して直ちに遮断するような製品もある  
* SELinux  
    - 侵入された場合の被害をできるだけ抑える仕組み  
    - Liunxには標準的に食い見込まれているセキュリティ機構の名称  

###5-3 サーバーに求められる技術  
* 最新のソフトウェアを使う  
    - セキュリティ上問題のあるソフトウェアは使わない、もし使っているソフトウェアに脆弱性が発見されたのであれば、直ちに更新するというのはセキュリティの基本  
* 不要なソフトを削除する  
    - インストールされているソフトウェアが多ければ多いほど、それらの中に不具合が潜む可能性が高くなる  
    - 必要のないソフトウェアは最初からインストールせず、もしインストールされているのであれば削除する  
* ログインを制限する  
    - SSHサーバーの設定を変更して安全性を高める  
    - 設定の変更はrootユーザーにしかできない  
    - 設定の変更を有効にするにはSSHサーバーを再起動が必要  

|変更前|変更後|  
|:-----|:-----|  
|#Port 22|Port 2022|  
|#PermitRootLogin yes|PermitRootLogin no|

* 開いているポートを確認する  
    - netstatコマンドを使うと、サーバーで開いているポートが−確認できる  
CentOSでのポート番号と、主なサービスの対応  

|ポート番号|サービス|  
|:---------|:-------|  
|20,21     |vsftpd(FTP)|  
|22        |sshd(SSH)|  
|23        |telnet(Telnet)|  
|25        |postfix(Mail)|  
|53        |named(DNS)|  
|80,443    | httpd(Web)|
|3306      |MySQL|
|5432      |PostgreSQL|

##6.実践的Linuxサーバー管理とトラブル対応  
###6-1 管理者が知っておきたい基本操作  
* サーバーの基本情報を確認する  
サーバーの基本情報シートの例  

|項目名|調査結果|  
|:-----|:-------|  
|ホスト名|centos.example.com|
|CPU|Intel Xeon 2.4GHz|
|HDD|107Gバイト|
|パーティション構成|/,/boot|
|メモリ|1Gバイト|
|IPアドレス|192.168.0.3|
|デフォルトゲートウェイ|192.168.0.1|
|ディストビリューション|CentOS|
|アーキテクチャ|x86_64|
|バージョン|6.4|
|Webサーバー|Apache 2.2.15|  

###6-2 トラブルに対処する  
* コマンドが実行できない  
    - 大体の原因はスペルミス  
    - 指定したファイル名の表記ミス  
    - 権限がない  
*パスワードを忘れた  
    - rootユーザーでもパスワードを調べることはできないので、パスワードを再設定する  
* rootユーザーのパスワードがわからない  
    - システムでsudoコマンドが使えるユーザーがイルカ確認する  
    - sudoコマンドでrootユーザーの全コマンドが実行できるようであれば、suコマンドを使ってrootユーザーになり、パスワードの再設定をする  
* インターネットにつながらない  
    - ネットワークが有効か調べる  
    - ネットワークを再起動する  
    - 8.8.8.8のサーバーと通信できるか調べる  
    - ファイヤーウォール機能を無効にする  
* SSHに接続できない  
    - サーバーがダウンしている  
    - サーバーまでのネットワークに不具合が発生している  
    - ファイヤウォールで遮られている  
    - SSHサーバーが稼働していない  
    - SSHのポート番号が変更されている  
* Webサーバーが応答しない  
    - 開いているポートを確認する  
    - Webサーバーが動作しているか確認する  
    - Webサーバーが動作していない場合は起動する  

###6-3 vi エディタを使ってみる  
* viエディタとは  
    - テキストファイルを編集するテキストエディタ  
*2つのモード  
    - viエディタには挿入モードとコマンドモードを切り替えながら編集作業を行います  
挿入モードに切り替えるコマンド  

|コマンド|説明|  
|:-------|:---|  
|-i      |カーソルの位置から文字の挿入を開始|  
|I       |行頭に移動し、そこから文字の挿入を開始|  
|o       |カーソルの下に空白行を作成し、そこから文字の挿入開始|  
|O       |カーソルの上に空白行を作成し、そこから文字の挿入開始|  
|a       |カーソル位置の右側から文字の挿入を開始|  
|A       |行末にカーソルを移動し、そこから文字の挿入を開始|  

* viエディタを終了  
    - コマンドモードで「:q」と入力し[Enter]キーを押す  

* カーソルを移動  
カーソル移動コマンド  

|コマンド|説明|  
|:-------|:---|  
|0       |カーソルのある行の行頭に移動|  
|$       |カーソルのある行の行末に移動|  
|gg      |ファイルの先頭に移動|  
|G       |ファイルの行末に移動|  
|nG      |ファイルのn行目に移動|  

###感想  
最近触ったものから前に触ったものまで一通りあって、復習している感覚になった。  
今まで結構勉強してきたんだなーって思いました。  

###ツッコミどころ  
どこをつっこめと(´・ω・｀)  